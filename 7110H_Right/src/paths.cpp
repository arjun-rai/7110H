#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
21.117,-149.68,120,0
23.11,-149.842,120
25.105,-149.981,120
27.102,-150.102,120
29.099,-150.209,120
31.097,-150.303,120
33.095,-150.387,120
35.093,-150.463,120
37.092,-150.53,120
39.091,-150.591,120
41.091,-150.646,120
43.09,-150.695,120
45.089,-150.739,120
47.089,-150.779,120
49.089,-150.815,120
51.088,-150.847,120
53.088,-150.876,120
55.088,-150.901,120
57.088,-150.924,120
59.088,-150.944,120
61.088,-150.961,120
63.088,-150.975,120
65.088,-150.988,120
67.088,-150.998,120
69.088,-151.006,120
71.088,-151.012,120
73.088,-151.017,120
75.088,-151.02,120
77.088,-151.021,120
79.088,-151.021,120
81.088,-151.02,120
83.088,-151.017,120
85.088,-151.014,120
87.088,-151.009,120
89.088,-151.003,120
91.088,-150.996,120
93.088,-150.989,120
95.088,-150.981,120
97.088,-150.972,120
99.088,-150.963,120
101.087,-150.954,120
103.087,-150.946,120
105.087,-150.937,120
107.087,-150.93,120
109.087,-150.925,120
111.173,-150.922,120,0
111.173,-150.922,0,0
#PATH-POINTS-START Path
111.173,-150.922,120,0
112.573,-149.494,120
113.973,-148.065,120
115.373,-146.637,120
116.773,-145.209,120
118.172,-143.78,120
119.572,-142.352,120
120.972,-140.923,120
122.372,-139.495,120
123.772,-138.066,120
125.172,-136.638,120
126.572,-135.21,120
127.971,-133.781,120
129.371,-132.353,120
130.771,-130.924,120
132.171,-129.496,120
133.571,-128.067,120
134.971,-126.639,120
136.371,-125.211,120
137.77,-123.782,120
139.17,-122.354,120
140.57,-120.925,120
141.606,-119.868,120,0
141.606,-119.868,0,0
#PATH-POINTS-START Path
140.985,-119.247,120,0
141.206,-117.259,120
141.427,-115.272,120
141.648,-113.284,120
141.868,-111.296,120
142.089,-109.308,120
142.31,-107.321,120
142.531,-105.333,120
142.752,-103.345,120
142.973,-101.357,120
143.194,-99.37,120
143.414,-97.382,120
143.635,-95.394,120
143.856,-93.406,120
144.077,-91.418,120
144.298,-89.431,120
144.519,-87.443,120
144.74,-85.455,120
144.961,-83.467,120
145.181,-81.48,120
145.402,-79.492,120
145.623,-77.504,120
145.844,-75.516,120
146.065,-73.529,120
146.286,-71.541,120
146.507,-69.553,120
146.727,-67.565,120
146.948,-65.577,120
147.196,-63.35,120,0
147.196,-63.35,0,0
#PATH-POINTS-START Path
146.575,-63.971,120,0
146.505,-65.97,120
146.434,-67.969,120
146.364,-69.967,120
146.294,-71.966,120
146.224,-73.965,120
146.154,-75.964,120
146.084,-77.963,120
146.014,-79.961,120
145.944,-81.96,120
145.873,-83.959,120
145.803,-85.958,120
145.733,-87.956,120
145.663,-89.955,120
145.593,-91.954,120
145.523,-93.953,120
145.453,-95.951,120
145.382,-97.95,120
145.333,-99.373,120,0
145.333,-99.373,0,0)";

std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {300, 0, 500, 0, 0};
std::vector<double> startSpeed = {400, 300, 300, 300, 300};
//