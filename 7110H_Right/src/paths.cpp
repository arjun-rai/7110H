#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
21.117,-149.68,120,0
23.11,-149.846,120
25.104,-149.996,120
27.099,-150.133,120
29.095,-150.259,120
31.092,-150.376,120
33.089,-150.485,120
35.086,-150.587,120
37.084,-150.683,120
39.082,-150.773,120
41.08,-150.859,120
43.079,-150.94,120
45.077,-151.017,120
47.076,-151.09,120
49.075,-151.16,120
51.074,-151.226,120
53.073,-151.289,120
55.072,-151.35,120
57.071,-151.407,120
59.07,-151.463,120
61.069,-151.515,120
63.069,-151.566,120
65.068,-151.614,120
67.068,-151.66,120
69.067,-151.704,120
71.067,-151.746,120
73.066,-151.786,120
75.066,-151.824,120
77.066,-151.86,120
79.065,-151.894,120
81.065,-151.926,120
83.065,-151.957,120
85.065,-151.986,120
87.064,-152.013,120
89.064,-152.038,120
91.064,-152.062,120
93.064,-152.083,120
95.064,-152.102,120
97.064,-152.119,120
99.064,-152.134,120
101.064,-152.147,120
103.064,-152.156,120
105.064,-152.162,120
106.826,-152.164,120,0
106.826,-152.164,0,0
#PATH-POINTS-START Path
106.205,-152.164,120,0
107.796,-150.953,120
109.387,-149.742,120
110.979,-148.53,120
112.57,-147.319,120
114.162,-146.108,120
115.753,-144.896,120
117.344,-143.685,120
118.936,-142.473,120
120.527,-141.262,120
122.119,-140.051,120
123.71,-138.839,120
125.301,-137.628,120
126.893,-136.417,120
128.484,-135.205,120
130.076,-133.994,120
131.667,-132.782,120
133.258,-131.571,120
134.85,-130.36,120
136.441,-129.148,120
138.033,-127.937,120
139.624,-126.726,120
141.216,-125.514,120
142.807,-124.303,120
144.398,-123.092,120
145.99,-121.88,120
147.817,-120.489,120,0
147.817,-120.489,0,0
#PATH-POINTS-START Path
147.817,-118.005,120,0
147.795,-116.005,120
147.773,-114.005,120
147.752,-112.005,120
147.73,-110.006,120
147.708,-108.006,120
147.686,-106.006,120
147.665,-104.006,120
147.643,-102.006,120
147.621,-100.006,120
147.599,-98.006,120
147.578,-96.006,120
147.556,-94.006,120
147.534,-92.007,120
147.513,-90.007,120
147.491,-88.007,120
147.469,-86.007,120
147.447,-84.007,120
147.426,-82.007,120
147.404,-80.007,120
147.382,-78.007,120
147.36,-76.008,120
147.339,-74.008,120
147.317,-72.008,120
147.295,-70.008,120
147.273,-68.008,120
147.252,-66.008,120
147.23,-64.008,120
147.208,-62.008,120
147.196,-60.866,120,0
147.196,-60.866,0,0
#PATH-POINTS-START Path
146.575,-62.729,120,0
146.507,-64.728,120
146.439,-66.727,120
146.371,-68.726,120
146.304,-70.724,120
146.236,-72.723,120
146.168,-74.722,120
146.1,-76.721,120
146.033,-78.72,120
145.965,-80.719,120
145.897,-82.718,120
145.829,-84.716,120
145.762,-86.715,120
145.694,-88.714,120
145.626,-90.713,120
145.558,-92.712,120
145.491,-94.711,120
145.423,-96.709,120
145.355,-98.708,120
145.333,-99.373,120,0
145.333,-99.373,0,0
#PATH-POINTS-START Path
145.333,-99.994,120,0
143.407,-99.453,120
141.482,-98.911,120
139.556,-98.37,120
137.631,-97.829,120
135.706,-97.288,120
133.78,-96.747,120
131.855,-96.205,120
129.929,-95.664,120
128.004,-95.123,120
126.079,-94.582,120
124.153,-94.041,120
122.228,-93.499,120
120.303,-92.958,120
118.377,-92.417,120
116.452,-91.876,120
114.526,-91.335,120
112.601,-90.794,120
110.676,-90.252,120
108.75,-89.711,120
106.825,-89.17,120
104.899,-88.629,120
102.974,-88.088,120
101.049,-87.546,120
99.123,-87.005,120
97.198,-86.464,120
95.272,-85.923,120
93.347,-85.382,120
91.422,-84.84,120
89.496,-84.299,120
87.571,-83.758,120
85.646,-83.217,120
83.72,-82.676,120
81.795,-82.134,120
79.869,-81.593,120
77.944,-81.052,120
76.019,-80.511,120
74.093,-79.97,120
72.168,-79.429,120
70.242,-78.887,120
68.317,-78.346,120
66.392,-77.805,120
64.466,-77.264,120
62.541,-76.723,120
60.616,-76.181,120
58.69,-75.64,120
56.765,-75.099,120
54.839,-74.558,120
52.914,-74.017,120
50.989,-73.475,120
49.063,-72.934,120
47.138,-72.393,120
45.212,-71.852,120
43.287,-71.311,120
41.362,-70.77,120
39.436,-70.228,120
37.511,-69.687,120
35.586,-69.146,120
33.66,-68.605,120
31.735,-68.064,120
30.433,-67.698,120,0
30.433,-67.698,0,0)";

std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {300, 0, 500, 0, 0};
std::vector<double> startSpeed = {400, 300, 300, 300, 300};
//