#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
21.117,-149.68,120,0
23.112,-149.818,120
25.11,-149.892,120
27.11,-149.912,120
29.11,-149.889,120
31.109,-149.83,120
33.107,-149.739,120
35.104,-149.622,120
37.099,-149.481,120
39.092,-149.319,120
41.084,-149.14,120
43.074,-148.944,120
45.063,-148.734,120
47.051,-148.512,120
49.037,-148.279,120
51.022,-148.036,120
53.007,-147.784,120
54.99,-147.524,120
56.972,-147.258,120
58.953,-146.985,120
60.934,-146.708,120
62.914,-146.426,120
64.894,-146.142,120
66.873,-145.854,120
68.852,-145.565,120
70.831,-145.275,120
72.809,-144.985,120
74.788,-144.695,120
76.768,-144.407,120
78.747,-144.122,120
80.727,-143.841,120
82.708,-143.564,120
84.69,-143.294,120
86.672,-143.032,120
88.656,-142.78,120
90.642,-142.539,120
92.629,-142.315,120
94.619,-142.109,120
96.61,-141.927,120
98.605,-141.776,120
100.601,-141.665,120
103.099,-141.606,120,0
103.099,-141.606,0,0
#PATH-POINTS-START Path
104.341,-142.227,120,0
105.985,-141.087,120
107.628,-139.948,120
109.272,-138.808,120
110.915,-137.668,120
112.558,-136.528,120
114.202,-135.388,120
115.845,-134.249,120
117.489,-133.109,120
119.132,-131.969,120
120.776,-130.829,120
122.419,-129.689,120
124.062,-128.55,120
125.706,-127.41,120
127.349,-126.27,120
128.993,-125.13,120
130.636,-123.99,120
132.28,-122.851,120
133.923,-121.711,120
135.566,-120.571,120
137.21,-119.431,120
138.853,-118.291,120
140.497,-117.152,120
142.14,-116.012,120
142.848,-115.521,120,0
142.848,-115.521,0,0
#PATH-POINTS-START Path
144.09,-116.142,120,0
144.319,-114.155,120
144.547,-112.168,120
144.776,-110.181,120
145.004,-108.194,120
145.232,-106.207,120
145.461,-104.22,120
145.689,-102.233,120
145.917,-100.246,120
146.146,-98.26,120
146.374,-96.273,120
146.603,-94.286,120
146.831,-92.299,120
147.059,-90.312,120
147.288,-88.325,120
147.516,-86.338,120
147.744,-84.351,120
147.973,-82.364,120
148.201,-80.377,120
148.43,-78.39,120
148.658,-76.403,120
148.886,-74.417,120
149.115,-72.43,120
149.343,-70.443,120
149.572,-68.456,120
149.8,-66.469,120
150.028,-64.482,120
150.301,-62.108,120,0
150.301,-62.108,0,0
#PATH-POINTS-START Path
150.301,-62.108,120,0
150.037,-64.09,120
149.773,-66.073,120
149.508,-68.055,120
149.244,-70.038,120
148.98,-72.02,120
148.715,-74.003,120
148.451,-75.985,120
148.187,-77.968,120
147.922,-79.95,120
147.658,-81.932,120
147.394,-83.915,120
147.129,-85.897,120
146.865,-87.88,120
146.601,-89.862,120
146.336,-91.845,120
146.072,-93.827,120
145.808,-95.81,120
145.543,-97.792,120
145.333,-99.373,120,0
145.333,-99.373,0,0)";

std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {300, 0, 500, 0, 0};
std::vector<double> startSpeed = {400, 300, 300, 300, 300};
//