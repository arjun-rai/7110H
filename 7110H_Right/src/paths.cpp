#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
98.313,-153.708,120,0
98.069,-151.723,120
97.773,-149.745,120
97.428,-147.775,120
97.035,-145.814,120
96.593,-143.864,120
96.102,-141.925,120
95.569,-139.997,120
94.996,-138.081,120
94.383,-136.178,120
93.731,-134.287,120
93.041,-132.41,120
92.317,-130.545,120
91.562,-128.693,120
90.777,-126.854,120
89.963,-125.027,120
89.119,-123.214,120
88.25,-121.413,120
87.357,-119.623,120
86.441,-117.845,120
85.505,-116.078,120
84.549,-114.321,120
83.572,-112.576,120
82.578,-110.84,120
81.568,-109.114,120
80.543,-107.397,120
79.504,-105.688,120
78.453,-103.987,120
77.389,-102.293,120
76.314,-100.607,120
75.228,-98.927,120
74.134,-97.253,120
73.031,-95.585,120
71.921,-93.921,120
70.804,-92.262,120
69.682,-90.606,120
68.555,-88.954,120
67.424,-87.304,120
66.29,-85.657,120
65.153,-84.012,120
64.014,-82.368,120
62.875,-80.724,120
61.735,-79.08,120
60.596,-77.436,120
59.459,-75.791,120
58.324,-74.144,120
57.192,-72.495,120
56.065,-70.843,120
54.942,-69.188,120
53.825,-67.529,120
52.715,-65.866,120
51.612,-64.197,120
50.518,-62.523,120
49.434,-60.842,120
48.362,-59.154,120
47.301,-57.458,120
46.253,-55.755,120
45.22,-54.043,120
44.202,-52.321,120
43.202,-50.589,120
42.221,-48.846,120
41.261,-47.092,120
40.321,-45.326,120
39.405,-43.548,120
38.517,-41.756,120
37.656,-39.951,120
36.825,-38.132,120
36.023,-36.3,120
35.261,-34.451,120
34.534,-32.588,120
33.845,-30.71,120
33.2,-28.817,120
32.602,-26.909,120
32.05,-24.986,120
31.549,-23.05,120
31.107,-21.1,120
30.719,-19.138,120
30.39,-17.165,120
30.13,-15.183,120
29.932,-13.192,120
29.803,-11.197,120
29.749,-9.198,120
29.763,-7.198,120
29.855,-5.2,120,0
30.017,-3.207,120
30.219,-1.217,120
30.46,0.768,120
30.736,2.749,120
31.049,4.724,120
31.405,6.692,120
31.801,8.653,120
32.241,10.604,120
32.726,12.544,120
33.256,14.472,120
33.836,16.386,120
34.463,18.285,120
35.137,20.168,120
35.863,22.032,120
36.638,23.876,120
37.459,25.699,120
38.328,27.5,120
39.246,29.277,120
40.207,31.031,120
41.211,32.761,120
42.255,34.466,120
43.337,36.149,120
44.455,37.807,120
45.606,39.443,120
46.785,41.058,120
47.992,42.653,120
49.222,44.23,120
50.474,45.789,120
51.745,47.333,120
53.031,48.865,120
54.331,50.385,120
55.643,51.894,120
56.964,53.396,120
58.291,54.892,120
59.625,56.383,120
60.961,57.871,120
62.3,59.357,120
63.639,60.842,120
64.977,62.328,120
66.313,63.817,120
67.646,65.308,120
68.975,66.803,120
70.298,68.302,120
71.615,69.808,120
72.925,71.319,120
74.228,72.836,120
75.522,74.362,120
76.807,75.894,120
78.082,77.434,120
79.348,78.983,120
80.604,80.54,120
81.848,82.105,120
83.081,83.68,120
84.303,85.263,120
85.514,86.855,120
86.713,88.456,120
87.899,90.066,120
89.074,91.685,120
90.236,93.312,120
91.387,94.948,120
92.525,96.593,120
93.651,98.246,120
94.763,99.908,120
95.864,101.578,120
96.951,103.256,120
98.027,104.942,120
99.091,106.636,120,0
99.811,108.431,120
99.818,110.431,120
99.833,112.431,120
99.852,114.431,120
99.872,116.43,120
99.888,118.43,120
99.894,120.43,120
99.882,122.43,120
99.841,124.43,120
99.755,126.428,120
99.605,128.422,120
99.366,130.408,120
98.995,132.372,120
98.447,134.294,120
97.665,136.133,120
96.606,137.826,120
95.267,139.308,120
93.696,140.541,120
91.962,141.535,120
90.127,142.329,120
88.23,142.96,120
86.296,143.469,120
84.34,143.884,120
82.369,144.225,120
80.39,144.509,120
78.404,144.742,120
76.414,144.942,120
74.42,145.108,120
72.426,145.25,120
70.429,145.372,120
68.432,145.475,120
66.434,145.563,120
64.435,145.639,120
62.436,145.705,120
60.437,145.762,120
58.438,145.812,120
56.438,145.854,120
54.439,145.892,120
52.439,145.924,120
50.439,145.953,120
48.439,145.978,120
46.439,146.001,120
44.44,146.022,120
42.44,146.04,120
40.44,146.057,120
38.44,146.072,120
36.44,146.087,120
34.44,146.101,120
32.44,146.114,120
30.44,146.127,120
28.44,146.14,120
26.44,146.153,120
24.44,146.166,120
22.44,146.18,120
20.44,146.194,120
18.44,146.208,120
16.44,146.223,120
14.44,146.239,120
12.44,146.255,120
10.44,146.272,120
8.441,146.291,120
6.441,146.31,120
4.441,146.33,120
2.441,146.351,120
0.441,146.373,120
-1.559,146.397,120
-3.559,146.421,120
-5.559,146.447,120
-7.558,146.473,120
-9.558,146.502,120
-11.558,146.53,120
-13.558,146.561,120
-15.558,146.592,120
-17.557,146.626,120
-19.557,146.659,120
-21.557,146.696,120
-23.556,146.732,120
-25.556,146.771,120
-27.556,146.809,120
-29.555,146.851,120
-31.555,146.892,120
-33.554,146.936,120
-35.554,146.981,120
-37.553,147.027,120
-39.553,147.074,120
-41.552,147.123,120,0
-45.414,147.22,120
-45.414,147.22,0,0
#PATH-POINTS-START Path
-41.92,147.719,120,0
-43.92,147.664,120
-45.919,147.61,120
-47.918,147.555,120
-49.917,147.5,120
-51.917,147.445,120
-53.916,147.391,120
-55.915,147.336,120
-57.914,147.281,120
-59.914,147.226,120
-61.913,147.172,120
-63.912,147.117,120
-65.911,147.062,120
-67.911,147.007,120
-69.91,146.952,120
-71.909,146.898,120
-73.908,146.843,120
-75.908,146.788,120
-77.907,146.733,120
-79.635,145.842,120,0
-81.245,144.657,120
-82.802,143.402,120
-84.297,142.073,120
-85.718,140.667,120
-87.06,139.184,120
-88.307,137.621,120
-89.452,135.981,120
-90.478,134.266,120
-91.382,132.482,120
-92.152,130.637,120
-92.782,128.739,120
-93.272,126.801,120
-93.625,124.833,120
-93.845,122.845,120
-93.934,120.847,120
-93.905,118.848,120
-93.767,116.853,120
-93.528,114.867,120
-93.198,112.895,120
-92.787,110.938,120
-92.3,108.998,120
-91.75,107.076,120
-91.137,105.172,120
-90.473,103.285,120
-89.761,101.416,120
-89.006,99.565,120
-88.213,97.728,120
-87.386,95.908,120
-86.527,94.101,120
-85.641,92.308,120
-84.731,90.527,120
-83.799,88.758,120
-82.846,86.999,120
-81.877,85.25,120
-80.892,83.51,120
-79.893,81.777,120
-78.883,80.05,120
-77.863,78.33,120
-76.834,76.615,120
-75.798,74.904,120
-74.755,73.198,120,0
-73.687,71.507,120
-72.63,69.809,120
-71.586,68.103,120
-70.562,66.385,120
-69.562,64.653,120
-68.594,62.903,120
-67.662,61.134,120
-66.775,59.341,120
-65.938,57.525,120
-65.156,55.684,120
-64.435,53.819,120
-63.775,51.931,120
-63.181,50.021,120
-62.648,48.094,120
-62.178,46.15,120
-61.764,44.193,120
-61.407,42.225,120
-61.101,40.249,120
-60.84,38.266,120
-60.622,36.278,120
-60.442,34.286,120
-60.296,32.292,120
-60.181,30.295,120
-60.094,28.297,120
-60.033,26.298,120
-59.994,24.298,120
-59.976,22.298,120
-59.976,20.298,120
-59.992,18.298,120
-60.024,16.299,120
-60.07,14.299,120
-60.127,12.3,120
-60.196,10.301,120
-60.276,8.303,120
-60.364,6.305,120
-60.461,4.307,120
-60.566,2.31,120
-60.679,0.313,120
-60.798,-1.683,120
-60.923,-3.68,120
-61.054,-5.675,120
-61.189,-7.671,120
-61.33,-9.666,120
-61.475,-11.66,120
-61.624,-13.655,120
-61.778,-15.649,120
-61.934,-17.643,120
-62.094,-19.636,120
-62.257,-21.63,120
-62.423,-23.623,120
-62.591,-25.616,120
-62.762,-27.609,120
-62.935,-29.601,120
-63.11,-31.593,120
-63.287,-33.585,120
-63.467,-35.577,120
-63.647,-37.569,120
-63.83,-39.561,120
-64.014,-41.552,120
-64.199,-43.544,120
-64.386,-45.535,120
-64.574,-47.526,120
-64.763,-49.517,120
-64.953,-51.508,120
-65.145,-53.499,120,0
-65.337,-55.49,120
-65.889,-57.403,120
-66.596,-59.274,120
-67.381,-61.113,120
-68.251,-62.913,120
-69.208,-64.669,120
-70.255,-66.373,120
-71.398,-68.014,120
-72.629,-69.59,120
-73.951,-71.09,120
-75.355,-72.514,120
-76.834,-73.86,120
-78.38,-75.128,120
-79.981,-76.327,120
-81.625,-77.465,120
-83.303,-78.554,120
-85.002,-79.61,120
-86.711,-80.648,120
-88.418,-81.69,120
-90.112,-82.753,120
-91.778,-83.859,120
-93.401,-85.028,120
-94.962,-86.277,120
-96.442,-87.622,120
-97.819,-89.072,120
-99.077,-90.626,120
-100.201,-92.28,120
-101.183,-94.022,120
-102.025,-95.835,120
-102.734,-97.704,120
-103.315,-99.618,120
-103.784,-101.562,120
-104.15,-103.528,120
-104.426,-105.508,120
-104.62,-107.499,120
-104.744,-109.495,120
-104.807,-111.494,120
-104.809,-113.494,120
-104.764,-115.493,120
-104.673,-117.491,120
-104.544,-119.487,120
-104.375,-121.479,120,0
-103.543,-123.208,120
-102.213,-124.701,120
-100.792,-126.108,120
-99.285,-127.422,120
-97.701,-128.642,120
-96.047,-129.766,120
-94.333,-130.797,120
-92.568,-131.736,120
-90.759,-132.588,120
-88.914,-133.359,120
-87.039,-134.056,120
-85.139,-134.681,120
-83.22,-135.241,120
-81.284,-135.745,120
-79.336,-136.198,120
-77.377,-136.602,120
-75.41,-136.963,120
-73.437,-137.288,120
-71.458,-137.575,120
-69.474,-137.834,120
-67.488,-138.063,120
-65.498,-138.269,120
-63.507,-138.452,120
-61.513,-138.616,120
-59.519,-138.762,120
-57.523,-138.892,120
-55.527,-139.01,120
-53.529,-139.114,120
-51.532,-139.209,120
-49.533,-139.295,120
-47.535,-139.372,120
-45.536,-139.443,120
-43.537,-139.509,120
-41.538,-139.57,120
-39.539,-139.627,120
-37.54,-139.682,120
-35.54,-139.734,120
-33.541,-139.785,120
-31.542,-139.836,120
-29.542,-139.886,120
-27.543,-139.938,120
-25.544,-139.99,120
-23.544,-140.045,120
-21.545,-140.101,120
-19.546,-140.16,120
-17.547,-140.222,120
-15.548,-140.288,120
-13.549,-140.357,120
-11.551,-140.431,120
-9.552,-140.509,120
-7.554,-140.592,120
-5.556,-140.68,120
-3.558,-140.774,120
-1.561,-140.873,120
0.437,-140.978,120
2.434,-141.09,120
4.43,-141.207,120
6.426,-141.331,120
8.422,-141.462,120
10.417,-141.6,120
12.412,-141.745,120
14.406,-141.897,120
16.4,-142.057,120
18.393,-142.225,120
20.385,-142.4,120
22.377,-142.584,120
24.367,-142.775,120
26.357,-142.974,120
28.347,-143.181,120
30.335,-143.396,120
32.323,-143.62,120
34.309,-143.853,120
36.294,-144.095,120
38.279,-144.345,120
40.262,-144.603,120
42.244,-144.87,120
44.225,-145.145,120
46.204,-145.431,120
48.183,-145.725,120
51.402,-146.222,120,0
51.402,-146.222,0,0)";
std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {300, 0};
std::vector<double> startSpeed = {300, 300};
//

