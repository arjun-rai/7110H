#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
-76.393,-140.053,120,0
-76.622,-138.067,120
-76.849,-136.079,120
-77.072,-134.092,120
-77.289,-132.104,120
-77.5,-130.115,120
-77.701,-128.125,120
-77.891,-126.134,120
-78.066,-124.142,120
-78.221,-122.148,120
-78.354,-120.152,120
-78.457,-118.155,120
-78.528,-116.156,120
-78.563,-114.157,120
-78.561,-112.157,120
-78.524,-110.157,120
-78.458,-108.158,120
-78.367,-106.16,120
-78.258,-104.163,120
-78.135,-102.167,120
-78.004,-100.171,120
-77.867,-98.176,120
-77.727,-96.181,120
-77.585,-94.186,120
-77.444,-92.191,120
-77.303,-90.196,120
-77.164,-88.201,120
-77.014,-86.019,120,0
-77.014,-86.019,0,0
#PATH-POINTS-START Path
-77.014,-87.262,120,0
-76.56,-85.314,120
-76.106,-83.366,120
-75.652,-81.418,120
-75.198,-79.47,120
-74.745,-77.523,120
-74.291,-75.575,120
-73.837,-73.627,120
-73.383,-71.679,120
-72.929,-69.731,120
-72.475,-67.783,120
-72.021,-65.836,120
-71.567,-63.888,120
-71.114,-61.94,120
-70.66,-59.992,120
-70.206,-58.044,120
-69.752,-56.096,120
-69.298,-54.149,120
-68.844,-52.201,120
-68.39,-50.253,120
-67.937,-48.305,120
-67.483,-46.357,120
-67.029,-44.41,120
-66.575,-42.462,120
-66.121,-40.514,120
-65.667,-38.566,120
-65.213,-36.618,120
-64.76,-34.67,120
-64.306,-32.723,120
-63.852,-30.775,120
-63.398,-28.827,120
-62.944,-26.879,120
-62.49,-24.931,120
-62.108,-23.29,120,0
-62.108,-23.29,0,0
#PATH-POINTS-START Path
-60.866,-21.427,120,0
-61.258,-23.388,120
-61.665,-25.347,120
-62.087,-27.302,120
-62.524,-29.253,120
-62.977,-31.201,120
-63.447,-33.145,120
-63.933,-35.085,120
-64.436,-37.021,120
-64.957,-38.952,120
-65.496,-40.878,120
-66.056,-42.798,120
-66.635,-44.712,120
-67.233,-46.621,120
-67.851,-48.523,120
-68.492,-50.417,120
-69.155,-52.304,120
-69.839,-54.183,120
-70.546,-56.054,120
-71.279,-57.915,120
-72.033,-59.767,120
-72.813,-61.609,120
-73.619,-63.44,120
-74.448,-65.259,120
-75.307,-67.066,120
-76.19,-68.86,120
-77.101,-70.641,120
-78.039,-72.407,120
-79.005,-74.158,120
-79.999,-75.894,120
-81.021,-77.613,120
-82.07,-79.315,120
-83.15,-80.999,120
-84.257,-82.665,120
-85.392,-84.311,120
-86.556,-85.938,120
-87.746,-87.545,120
-88.965,-89.13,120
-90.21,-90.696,120
-91.481,-92.24,120
-92.779,-93.762,120
-94.101,-95.262,120
-95.447,-96.742,120
-96.816,-98.199,120
-98.208,-99.635,120
-99.621,-101.051,120
-101.054,-102.446,120
-102.507,-103.82,120
-103.979,-105.174,120
-105.467,-106.51,120
-106.971,-107.829,120
-108.491,-109.129,120
-110.024,-110.413,120
-111.57,-111.681,120
-113.128,-112.936,120
-114.697,-114.177,120
-116.275,-115.405,120
-117.862,-116.622,120
-119.456,-117.829,120
-121.058,-119.027,120
-122.665,-120.217,120
-124.278,-121.401,120
-125.894,-122.579,120
-127.514,-123.752,120
-129.136,-124.922,120
-130.76,-126.089,120
-132.911,-127.632,120,17.6
-132.911,-127.632,0,17.6
#PATH-POINTS-START Path
-132.911,-127.011,120,0
-132.154,-128.861,120
-131.261,-130.65,120
-130.261,-132.382,120
-129.177,-134.063,120
-128.02,-135.694,120
-126.8,-137.278,120
-125.524,-138.818,120
-124.196,-140.314,120
-122.82,-141.765,120
-121.399,-143.173,120
-119.934,-144.534,120
-118.427,-145.849,120
-116.879,-147.115,120
-115.29,-148.329,120
-113.66,-149.487,120
-111.989,-150.587,120
-110.278,-151.622,120
-108.526,-152.587,120
-106.734,-153.474,120
-106.205,-153.717,120,13.899999999999999
-106.205,-153.717,0,13.899999999999999
#PATH-POINTS-START Path
-106.826,-154.338,120,0
-104.828,-154.232,120
-102.831,-154.133,120
-100.833,-154.042,120
-98.835,-153.958,120
-96.836,-153.882,120
-94.837,-153.813,120
-92.838,-153.752,120
-90.839,-153.696,120
-88.84,-153.649,120
-86.84,-153.607,120
-84.84,-153.572,120
-82.841,-153.542,120
-80.841,-153.519,120
-78.841,-153.502,120
-76.841,-153.491,120
-74.841,-153.485,120
-72.841,-153.485,120
-70.841,-153.49,120
-68.841,-153.501,120
-66.841,-153.516,120
-64.841,-153.537,120
-62.841,-153.563,120
-60.841,-153.593,120
-58.842,-153.628,120
-56.842,-153.667,120
-54.843,-153.711,120
-52.843,-153.759,120
-50.844,-153.812,120
-48.845,-153.868,120
-46.846,-153.928,120
-44.847,-153.992,120
-42.848,-154.06,120
-40.849,-154.131,120
-38.85,-154.206,120
-36.852,-154.283,120
-34.854,-154.364,120
-32.855,-154.447,120
-30.857,-154.533,120
-28.859,-154.621,120
-26.861,-154.711,120
-24.863,-154.802,120
-22.865,-154.895,120
-20.868,-154.989,120
-18.87,-155.082,120
-16.872,-155.175,120
-14.874,-155.265,120
-12.876,-155.352,120
-10.877,-155.433,120
-8.879,-155.504,120
-6.879,-155.558,120
-4.969,-155.58,120,0
-4.969,-155.58,0,0
#PATH-POINTS-START Path
-4.969,-153.096,120,0
-6.937,-153.448,120
-8.903,-153.816,120
-10.866,-154.202,120
-12.825,-154.604,120
-14.781,-155.019,120
-16.735,-155.449,120
-18.685,-155.89,120
-20.634,-156.342,120
-22.58,-156.802,120
-24.524,-157.271,120
-26.467,-157.746,120
-28.409,-158.225,120
-30.35,-158.707,120
-32.291,-159.19,120
-34.232,-159.672,120
-36.173,-160.152,120
-38.116,-160.626,120
-40.061,-161.094,120
-42.007,-161.553,120
-43.957,-162,120
-45.909,-162.434,120
-47.865,-162.851,120
-49.825,-163.25,120
-51.789,-163.628,120
-53.757,-163.98,120
-55.731,-164.307,120
-57.708,-164.605,120
-59.691,-164.868,120
-61.678,-165.097,120
-63.668,-165.289,120
-65.663,-165.437,120
-67.66,-165.542,120
-69.659,-165.601,120
-71.659,-165.611,120
-73.658,-165.567,120
-75.656,-165.471,120
-77.65,-165.322,120
-79.639,-165.113,120
-81.621,-164.847,120
-83.595,-164.524,120
-85.558,-164.14,120
-87.508,-163.698,120
-89.445,-163.201,120
-91.366,-162.642,120
-93.269,-162.03,120
-95.155,-161.362,120
-97.02,-160.641,120
-98.865,-159.87,120
-100.689,-159.05,120
-102.491,-158.182,120
-104.271,-157.271,120
-106.028,-156.315,120
-107.764,-155.321,120
-109.475,-154.286,120
-111.164,-153.216,120
-112.833,-152.113,120
-114.479,-150.977,120
-116.102,-149.808,120
-117.705,-148.613,120
-119.288,-147.39,120
-120.851,-146.143,120
-122.394,-144.871,120
-123.917,-143.574,120
-125.422,-142.257,120
-126.91,-140.92,120
-129.184,-138.811,120,0
-129.184,-138.811,0,0)";

std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {400, 300, 0, 0, 0, 0};
std::vector<double> startSpeed = {600, 400, 600, 400, 300, 400};
//