#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
-76.393,-140.053,120,0
-76.368,-138.054,120
-76.346,-136.054,120
-76.326,-134.054,120
-76.31,-132.054,120
-76.297,-130.054,120
-76.288,-128.054,120
-76.283,-126.054,120
-76.282,-124.054,120
-76.284,-122.054,120
-76.292,-120.054,120
-76.304,-118.054,120
-76.321,-116.054,120
-76.343,-114.054,120
-76.371,-112.054,120
-76.406,-110.055,120
-76.446,-108.055,120
-76.495,-106.056,120
-76.551,-104.056,120
-76.614,-102.057,120
-76.687,-100.059,120
-76.77,-98.06,120
-76.862,-96.063,120
-76.966,-94.065,120
-77.081,-92.069,120
-77.207,-90.073,120
-77.343,-88.077,120
-77.484,-86.082,120
-77.621,-84.087,120
-77.735,-82.09,120
-77.795,-80.091,120
-77.769,-78.092,120
-77.641,-76.096,120
-77.422,-74.108,120
-77.136,-72.129,120
-76.806,-70.156,120
-76.446,-68.189,120
-76.067,-66.225,120
-75.675,-64.264,120
-75.274,-62.304,120
-74.868,-60.346,120
-74.459,-58.389,120
-74.046,-56.431,120
-73.632,-54.475,120
-73.217,-52.518,120
-72.802,-50.562,120
-72.387,-48.605,120
-71.972,-46.649,120
-71.557,-44.693,120
-71.143,-42.736,120
-70.729,-40.779,120
-70.316,-38.822,120
-69.904,-36.865,120
-69.493,-34.908,120
-69.082,-32.95,120
-68.673,-30.993,120
-68.264,-29.035,120
-67.856,-27.077,120
-67.449,-25.119,120
-67.043,-23.161,120
-66.638,-21.202,120
-66.233,-19.243,120
-65.83,-17.285,120
-65.213,-14.285,120,0
-65.213,-14.285,0,0
#PATH-POINTS-START Path
-64.592,-13.664,120,0
-64.984,-15.625,120
-65.389,-17.583,120
-65.808,-19.539,120
-66.242,-21.492,120
-66.689,-23.441,120
-67.152,-25.387,120
-67.629,-27.329,120
-68.121,-29.267,120
-68.629,-31.202,120
-69.153,-33.132,120
-69.692,-35.058,120
-70.25,-36.978,120
-70.824,-38.894,120
-71.416,-40.805,120
-72.024,-42.71,120
-72.649,-44.61,120
-73.294,-46.503,120
-73.958,-48.39,120
-74.64,-50.27,120
-75.34,-52.143,120
-76.06,-54.009,120
-76.801,-55.867,120
-77.561,-57.717,120
-78.34,-59.559,120
-79.142,-61.391,120
-79.964,-63.214,120
-80.806,-65.028,120
-81.671,-66.831,120
-82.556,-68.625,120
-83.463,-70.407,120
-84.393,-72.178,120
-85.343,-73.938,120
-86.317,-75.685,120
-87.312,-77.419,120
-88.33,-79.141,120
-89.37,-80.849,120
-90.433,-82.544,120
-91.518,-84.224,120
-92.625,-85.89,120
-93.754,-87.54,120
-94.905,-89.175,120
-96.079,-90.795,120
-97.274,-92.399,120
-98.49,-93.986,120
-99.728,-95.557,120
-100.986,-97.112,120
-102.267,-98.648,120
-103.566,-100.169,120
-104.886,-101.671,120
-106.225,-103.157,120
-107.582,-104.625,120
-108.96,-106.076,120
-110.354,-107.51,120
-111.766,-108.925,120
-113.196,-110.324,120
-114.641,-111.706,120
-116.104,-113.071,120
-117.581,-114.419,120
-119.073,-115.751,120
-120.58,-117.066,120
-122.099,-118.366,120
-123.632,-119.651,120
-125.178,-120.92,120
-126.735,-122.175,120
-128.304,-123.415,120
-129.884,-124.642,120
-131.473,-125.856,120
-133.072,-127.057,120
-134.681,-128.246,120
-137.259,-130.116,120,17.6
-137.259,-130.116,0,17.6
#PATH-POINTS-START Path
-136.637,-130.737,120,0
-135.391,-132.301,120
-134.125,-133.849,120
-132.839,-135.381,120
-131.532,-136.895,120
-130.202,-138.389,120
-128.845,-139.858,120
-127.464,-141.304,120
-126.054,-142.723,120
-124.613,-144.11,120
-123.141,-145.463,120
-121.633,-146.778,120
-120.089,-148.048,120
-118.507,-149.271,120
-116.883,-150.439,120
-115.216,-151.543,120
-113.504,-152.577,120
-111.746,-153.53,120
-109.941,-154.392,120
-108.092,-155.154,120
-106.202,-155.806,120
-104.274,-156.336,120
-102.316,-156.739,120
-100.334,-157.008,120
-98.339,-157.145,120
-96.34,-157.151,120
-94.344,-157.033,120
-92.357,-156.804,120
-90.384,-156.477,120
-88.427,-156.066,120
-86.486,-155.584,120
-84.559,-155.05,120
-82.643,-154.476,120
-80.734,-153.878,120
-78.829,-153.269,120
-76.924,-152.663,120
-75.013,-152.071,120
-73.094,-151.506,120
-71.164,-150.983,120
-69.221,-150.511,120
-67.263,-150.102,120
-65.291,-149.769,120
-63.307,-149.521,120
-61.313,-149.366,120
-59.314,-149.311,120
-57.139,-149.37,120,13.899999999999999
-57.139,-149.37,0,13.899999999999999
#PATH-POINTS-START Path
-56.518,-150.612,120,0
-54.536,-150.348,120
-52.547,-150.137,120
-50.554,-149.965,120
-48.559,-149.824,120
-46.563,-149.706,120
-44.565,-149.609,120
-42.567,-149.528,120
-40.568,-149.462,120
-38.569,-149.408,120
-36.569,-149.365,120
-34.569,-149.331,120
-32.57,-149.306,120
-30.57,-149.288,120
-28.57,-149.277,120
-26.57,-149.271,120
-24.57,-149.271,120
-22.57,-149.274,120
-20.57,-149.282,120
-18.57,-149.292,120
-16.57,-149.305,120
-14.57,-149.319,120
-12.57,-149.334,120
-10.57,-149.348,120
-8.57,-149.361,120
-6.57,-149.368,120
-5.59,-149.37,120,0
-5.59,-149.37,0,0
#PATH-POINTS-START Path
-4.969,-153.096,120,0
-6.938,-153.446,120
-8.904,-153.81,120
-10.868,-154.189,120
-12.829,-154.58,120
-14.788,-154.984,120
-16.745,-155.397,120
-18.7,-155.819,120
-20.653,-156.249,120
-22.605,-156.684,120
-24.557,-157.123,120
-26.507,-157.565,120
-28.458,-158.006,120
-30.409,-158.444,120
-32.362,-158.878,120
-34.316,-159.306,120
-36.272,-159.723,120
-38.23,-160.129,120
-40.191,-160.52,120
-42.156,-160.892,120
-44.125,-161.244,120
-46.098,-161.574,120
-48.075,-161.876,120
-50.056,-162.148,120
-52.042,-162.388,120
-54.031,-162.593,120
-56.024,-162.759,120
-58.02,-162.884,120
-60.018,-162.967,120
-62.018,-163.006,120
-64.018,-162.994,120
-66.017,-162.934,120
-68.014,-162.827,120
-70.007,-162.667,120
-71.996,-162.455,120
-73.979,-162.195,120
-75.954,-161.88,120
-77.921,-161.517,120
-79.878,-161.105,120
-81.824,-160.642,120
-83.758,-160.136,120
-85.68,-159.581,120
-87.589,-158.985,120
-89.483,-158.344,120
-91.364,-157.664,120
-93.231,-156.947,120
-95.082,-156.19,120
-96.92,-155.401,120
-98.743,-154.579,120
-100.551,-153.723,120
-102.344,-152.838,120
-104.124,-151.927,120
-105.89,-150.988,120
-107.642,-150.022,120
-109.38,-149.033,120
-111.105,-148.021,120
-112.818,-146.989,120
-114.518,-145.935,120
-116.206,-144.863,120
-117.882,-143.772,120
-119.547,-142.664,120
-121.201,-141.539,120
-122.844,-140.399,120
-124.476,-139.243,120
-126.099,-138.073,120
-127.711,-136.89,120
-129.314,-135.694,120
-130.908,-134.486,120
-132.493,-133.266,120
-134.069,-132.036,120
-135.638,-130.795,120,0
-137.259,-129.495,120
-137.259,-129.495,0,0)";

std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {300, 0, 300, 0, 0};
std::vector<double> startSpeed = {600, 600, 600, 300, 400};
//