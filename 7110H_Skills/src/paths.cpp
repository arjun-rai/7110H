#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
157.133,-102.168,120,0
155.673,-103.535,120
154.194,-104.881,120
152.696,-106.205,120
151.178,-107.507,120
149.632,-108.777,120
148.068,-110.023,120
146.486,-111.247,120
144.886,-112.447,120
143.262,-113.614,120
141.62,-114.755,120
139.961,-115.872,120
138.286,-116.965,120
136.592,-118.028,120
134.879,-119.061,120
133.152,-120.069,120
131.411,-121.052,120
129.655,-122.01,120
127.881,-122.934,120
126.094,-123.833,120
124.295,-124.706,120
122.485,-125.555,120
120.661,-126.376,120
118.823,-127.166,120
116.976,-127.932,120
115.119,-128.674,120
113.252,-129.392,120
111.374,-130.08,120
109.487,-130.743,120
107.592,-131.382,120
105.69,-131.999,120
103.78,-132.592,120
101.861,-133.156,120
99.936,-133.698,120
98.005,-134.218,120
96.068,-134.717,120
94.126,-135.193,120
92.177,-135.643,120
90.224,-136.074,120
88.267,-136.485,120
86.305,-136.877,120
84.339,-137.244,120
82.37,-137.591,120
80.397,-137.921,120
78.422,-138.233,120
76.443,-138.525,120
74.462,-138.796,120
72.478,-139.051,120
70.492,-139.289,120
68.505,-139.512,120
66.515,-139.714,120
64.524,-139.9,120
62.531,-140.072,120
60.537,-140.229,120
58.542,-140.37,120
56.546,-140.494,120
54.549,-140.605,120
52.552,-140.704,120
50.553,-140.789,120
48.555,-140.858,120
46.555,-140.914,120
44.556,-140.959,120
42.556,-140.993,120
40.556,-141.014,120
38.556,-141.021,120
36.556,-141.019,120
34.556,-141.007,120
32.557,-140.984,120
30.557,-140.948,120
28.557,-140.904,120
26.558,-140.851,120
24.559,-140.789,120
22.56,-140.717,120
20.562,-140.635,120
18.564,-140.547,120
16.566,-140.45,120
14.569,-140.347,120
12.572,-140.234,120
10.576,-140.114,120
8.58,-139.988,120
6.584,-139.856,120
4.589,-139.718,120
2.594,-139.573,120
0.6,-139.423,120
-1.394,-139.268,120
-3.388,-139.108,120
-5.381,-138.943,120
-7.374,-138.774,120
-9.366,-138.601,120
-11.358,-138.424,120
-13.35,-138.244,120
-15.342,-138.062,120
-17.333,-137.876,120
-19.325,-137.688,120
-21.316,-137.498,120
-23.306,-137.307,120
-25.297,-137.115,120
-27.288,-136.922,120
-29.278,-136.729,120
-31.269,-136.536,120
-33.26,-136.343,120
-35.251,-136.152,120
-37.242,-135.961,120
-39.233,-135.773,120
-41.224,-135.588,120
-43.216,-135.405,120
-45.208,-135.226,120
-47.2,-135.052,120
-49.193,-134.883,120
-51.186,-134.719,120
-53.18,-134.561,120
-55.174,-134.411,120
-57.169,-134.268,120
-59.165,-134.135,120
-61.161,-134.011,120
-63.158,-133.899,120
-65.155,-133.798,120
-67.153,-133.711,120
-69.152,-133.639,120
-71.151,-133.583,120
-73.151,-133.545,120
-75.151,-133.527,120
-77.635,-133.532,120,0
-77.635,-133.532,0,0
#PATH-POINTS-START Path
-80.74,-128.563,120,0
-82.693,-128.132,120
-84.638,-127.667,120
-86.576,-127.17,120
-88.505,-126.641,120
-90.425,-126.084,120
-92.337,-125.497,120
-94.24,-124.881,120
-96.134,-124.238,120
-98.017,-123.566,120
-99.891,-122.866,120
-101.754,-122.14,120
-103.606,-121.385,120
-105.447,-120.602,120
-107.276,-119.793,120
-109.092,-118.955,120
-110.894,-118.087,120
-112.682,-117.193,120
-114.456,-116.268,120
-116.213,-115.314,120
-117.955,-114.33,120
-119.678,-113.315,120
-121.382,-112.268,120
-123.067,-111.191,120
-124.73,-110.079,120
-126.37,-108.935,120
-127.986,-107.758,120
-129.576,-106.543,120
-131.137,-105.294,120
-132.67,-104.009,120
-134.169,-102.685,120
-135.634,-101.324,120
-137.063,-99.924,120
-138.451,-98.485,120
-139.796,-97.005,120
-141.096,-95.485,120
-142.348,-93.925,120
-143.544,-92.323,120
-144.685,-90.68,120
-145.767,-88.999,120
-146.786,-87.278,120
-147.734,-85.517,120
-148.612,-83.72,120
-149.415,-81.889,120
-150.142,-80.026,120
-150.783,-78.131,120
-151.341,-76.211,120
-151.814,-74.268,120
-152.2,-72.306,120
-152.494,-70.328,120
-152.701,-68.339,120
-152.822,-66.343,120
-152.849,-64.343,120
-152.795,-62.344,120
-152.657,-60.349,120
-152.436,-58.361,120
-152.14,-56.384,120
-151.765,-54.419,120
-151.323,-52.469,120
-150.922,-50.928,120,0
-150.922,-50.928,0,0
#PATH-POINTS-START Path
-60.866,30.433,120,0
-61.301,32.385,120
-61.745,34.335,120
-62.199,36.283,120
-62.663,38.228,120
-63.136,40.172,120
-63.618,42.112,120
-64.11,44.051,120
-64.612,45.987,120
-65.123,47.921,120
-65.644,49.852,120
-66.174,51.78,120
-66.714,53.706,120
-67.264,55.629,120
-67.824,57.549,120
-68.395,59.466,120
-68.976,61.379,120
-69.568,63.29,120
-70.17,65.197,120
-70.784,67.1,120
-71.41,69,120
-72.049,70.895,120
-72.699,72.786,120
-73.362,74.673,120
-74.038,76.556,120
-74.728,78.433,120
-75.432,80.305,120
-76.152,82.171,120
-76.886,84.031,120
-77.637,85.885,120
-78.404,87.732,120
-79.19,89.571,120
-79.994,91.402,120
-80.818,93.225,120
-81.662,95.038,120
-82.529,96.84,120
-83.418,98.631,120
-84.333,100.41,120
-85.273,102.175,120
-86.242,103.925,120
-87.242,105.657,120
-88.274,107.37,120
-89.342,109.061,120
-90.447,110.728,120
-91.593,112.367,120
-92.785,113.973,120
-94.025,115.542,120
-95.32,117.066,120
-96.672,118.539,120
-98.091,119.949,120
-99.606,121.246,120,0
-101.362,122.203,120
-103.173,123.051,120
-105.037,123.774,120
-106.949,124.359,120
-108.9,124.793,120
-110.882,125.059,120
-112.879,125.145,120
-114.876,125.048,120
-116.855,124.761,120
-118.797,124.288,120
-120.688,123.639,120
-122.515,122.826,120
-124.267,121.864,120
-125.94,120.769,120
-127.531,119.557,120
-129.04,118.245,120
-130.47,116.848,120
-131.822,115.374,120
-133.101,113.837,120
-134.31,112.244,120
-135.455,110.604,120
-136.539,108.924,120
-137.565,107.207,120
-138.538,105.459,120
-139.46,103.685,120
-140.336,101.887,120
-141.166,100.068,120
-141.955,98.23,120
-142.705,96.376,120
-143.419,94.508,120
-144.099,92.627,120
-144.744,90.734,120
-145.36,88.831,120
-145.944,86.918,120
-146.502,84.998,120
-147.033,83.069,120
-147.539,81.134,120
-148.019,79.193,120
-148.479,77.246,120
-148.914,75.294,120
-149.329,73.338,120
-149.725,71.378,120
-150.301,68.319,120,0
-150.301,68.319,0,0)";
std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {50, 0, 0};
std::vector<double> startSpeed = {50, 50, 0};
//