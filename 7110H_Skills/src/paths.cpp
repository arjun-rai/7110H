#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
141.815,-112.579,120,0
140.843,-114.327,120
139.78,-116.021,120
138.637,-117.662,120
137.421,-119.25,120
136.14,-120.786,120
134.804,-122.274,120
133.417,-123.714,120
131.986,-125.111,120
130.514,-126.465,120
129.006,-127.778,120
127.465,-129.053,120
125.895,-130.292,120
124.297,-131.495,120
122.675,-132.665,120
121.03,-133.802,120
119.364,-134.909,120
117.679,-135.987,120
115.976,-137.035,120
114.256,-138.055,120
112.52,-139.049,120
110.769,-140.015,120
109.005,-140.957,120
107.226,-141.872,120
105.436,-142.763,120
103.633,-143.628,120
101.818,-144.469,120
99.992,-145.284,120
98.155,-146.075,120
96.306,-146.838,120
94.447,-147.576,120
92.577,-148.285,120
90.696,-148.965,120
88.804,-149.612,120
86.9,-150.225,120
84.984,-150.798,120
83.055,-151.325,120
81.111,-151.795,120
79.136,-152.087,120,0
77.144,-152.267,120
75.15,-152.429,120
73.156,-152.577,120
71.16,-152.711,120
69.164,-152.833,120
67.167,-152.944,120
65.17,-153.045,120
63.172,-153.138,120
61.174,-153.223,120
59.175,-153.3,120
57.176,-153.37,120
55.177,-153.434,120
53.178,-153.492,120
51.179,-153.543,120
49.179,-153.59,120
47.18,-153.632,120
45.18,-153.669,120
43.18,-153.702,120
41.181,-153.731,120
39.181,-153.756,120
37.181,-153.777,120
35.181,-153.794,120
33.181,-153.808,120
31.181,-153.819,120
29.181,-153.826,120
27.181,-153.831,120
25.181,-153.833,120
23.181,-153.832,120
21.181,-153.828,120
19.181,-153.822,120
17.181,-153.813,120
15.181,-153.802,120
13.181,-153.789,120
11.181,-153.773,120
9.181,-153.756,120
7.181,-153.736,120
5.181,-153.714,120
3.182,-153.691,120
1.182,-153.665,120
-0.818,-153.638,120
-2.818,-153.609,120
-4.818,-153.578,120
-6.817,-153.545,120
-8.817,-153.511,120
-10.817,-153.475,120
-12.816,-153.438,120
-14.816,-153.399,120
-16.816,-153.359,120
-18.815,-153.317,120
-20.815,-153.274,120
-22.814,-153.23,120
-24.814,-153.184,120
-26.813,-153.137,120
-28.813,-153.088,120
-30.812,-153.039,120
-32.811,-152.988,120
-34.811,-152.936,120
-36.81,-152.882,120
-38.809,-152.828,120
-40.808,-152.772,120
-42.808,-152.715,120
-44.807,-152.658,120
-46.806,-152.599,120
-48.805,-152.539,120
-50.804,-152.478,120
-52.803,-152.416,120
-54.802,-152.353,120
-56.801,-152.289,120
-58.8,-152.224,120
-60.799,-152.158,120
-62.798,-152.091,120
-64.797,-152.023,120
-66.795,-151.954,120
-68.794,-151.885,120
-70.793,-151.814,120
-72.792,-151.743,120
-74.79,-151.671,120
-76.789,-151.598,120
-78.788,-151.524,120
-80.786,-151.449,120
-82.785,-151.373,120
-84.783,-151.297,120
-86.782,-151.22,120
-88.78,-151.142,120
-91.295,-151.043,120,0
-91.295,-151.043,0,0
#PATH-POINTS-START Path
-91.698,-150.519,120,0
-93.643,-150.986,120
-95.616,-151.307,120
-97.608,-151.482,120
-99.607,-151.514,120
-101.604,-151.409,120
-103.589,-151.171,120
-105.556,-150.811,120
-107.498,-150.336,120
-109.411,-149.754,120
-111.292,-149.075,120
-113.138,-148.306,120
-114.948,-147.456,120
-116.721,-146.531,120
-118.457,-145.537,120
-120.154,-144.48,120
-121.813,-143.362,120
-123.435,-142.192,120
-125.02,-140.973,120
-126.569,-139.708,120
-128.082,-138.4,120
-129.558,-137.051,120
-131,-135.665,120
-132.408,-134.245,120
-133.779,-132.789,120
-135.117,-131.303,120
-136.423,-129.787,120
-137.692,-128.242,120
-138.928,-126.669,120
-140.131,-125.072,120
-141.298,-123.448,120
-142.432,-121.8,120
-143.532,-120.13,120
-144.594,-118.436,120
-145.622,-116.72,120
-146.615,-114.984,120
-147.567,-113.225,120
-148.483,-111.447,120
-149.36,-109.649,120
-150.193,-107.832,120
-150.985,-105.995,120
-151.733,-104.14,120
-152.436,-102.268,120
-153.087,-100.377,120
-153.687,-98.469,120
-154.234,-96.545,120
-154.723,-94.606,120
-155.15,-92.653,120
-155.509,-90.685,120
-155.796,-88.706,120
-156.006,-86.717,120
-156.132,-84.721,120
-156.167,-82.722,120
-156.104,-80.723,120
-155.932,-78.731,120
-155.81,-77.788,120,27.4
-155.81,-77.788,0,27.4
#PATH-POINTS-START Path
-73.434,39.933,120,0
-74.326,41.723,120
-75.187,43.528,120
-76.022,45.346,120
-76.831,47.175,120
-77.618,49.013,120
-78.384,50.861,120
-79.132,52.716,120
-79.864,54.577,120
-80.58,56.444,120
-81.284,58.316,120
-81.975,60.193,120
-82.655,62.074,120
-83.327,63.958,120
-83.99,65.845,120
-84.646,67.734,120
-85.296,69.625,120
-85.941,71.518,120
-86.583,73.413,120
-87.221,75.308,120
-87.858,77.204,120
-88.494,79.1,120
-89.13,80.996,120
-89.767,82.892,120
-90.407,84.787,120
-91.049,86.681,120
-91.696,88.574,120
-92.347,90.465,120
-93.005,92.353,120
-93.671,94.239,120
-94.345,96.122,120
-95.029,98.002,120
-95.725,99.877,120
-96.433,101.747,120
-97.155,103.612,120
-97.894,105.471,120
-98.65,107.322,120
-99.427,109.165,120
-100.225,110.999,120
-101.049,112.822,120
-101.899,114.632,120
-102.78,116.427,120
-103.695,118.206,120
-104.648,119.964,120
-105.643,121.699,120
-106.685,123.406,120
-107.779,125.08,120
-108.934,126.712,120
-110.153,128.298,120
-111.447,129.822,120
-112.822,131.275,120
-114.286,132.637,120,0
-116.05,133.573,120
-117.928,134.254,120
-119.891,134.62,120
-121.888,134.618,120
-123.847,134.232,120
-125.703,133.493,120
-127.423,132.477,120
-129.002,131.251,120
-130.447,129.869,120
-131.775,128.374,120
-133.002,126.795,120
-134.144,125.154,120
-135.209,123.461,120
-136.21,121.73,120
-137.155,119.967,120
-138.05,118.178,120
-138.9,116.368,120
-139.711,114.54,120
-140.486,112.696,120
-141.229,110.839,120
-141.943,108.971,120
-142.631,107.094,120
-143.295,105.207,120
-143.936,103.312,120
-144.557,101.411,120
-145.158,99.504,120
-145.741,97.591,120
-146.309,95.673,120
-146.86,93.75,120
-147.398,91.824,120
-147.921,89.894,120
-148.432,87.96,120
-148.93,86.023,120
-149.418,84.084,120
-149.894,82.141,120
-150.361,80.196,120
-150.817,78.249,120
-151.264,76.3,120
-151.703,74.348,120
-152.133,72.395,120
-152.555,70.44,120
-152.97,68.484,120
-153.377,66.525,120
-153.777,64.566,120
-154.171,62.605,120
-154.558,60.643,120
-154.939,58.68,120
-155.315,56.715,120
-155.684,54.75,120
-156.048,52.783,120
-156.469,50.477,120,0
-156.469,50.477,0,0)";
std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {50, 40, 100};
std::vector<double> startSpeed = {75, 50, 80};
//