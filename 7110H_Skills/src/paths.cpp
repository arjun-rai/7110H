#include "vex.h"
#include "paths.h"
#include "pure-pursuit.h"
std::vector<std::vector<pathPoint>> convert_to_path(std::string str)
{
    std::istringstream stream(str);
    std::string line;
    std::vector<std::vector<pathPoint>> paths;

    while (std::getline(stream, line)) {
        if (line.find("#PATH-POINTS-START Path") != std::string::npos) {
            // Start a new path for each "#PATH-POINTS-START Path"
            paths.push_back(std::vector<pathPoint>());
            continue;
        }

        std::istringstream lineStream(line);
        std::string token;

        // Skip the first two values and only consider the first two for x, y
        std::getline(lineStream, token, ','); // x
        double x = atof(token.c_str());

        std::getline(lineStream, token, ','); // y
        double y = atof(token.c_str());

        paths.back().push_back(point(x,y));
    }
    return paths;
}
const char * path_str = R"(#PATH-POINTS-START Path
141.815,-112.579,120,0
140.843,-114.327,120
139.777,-116.019,120
138.627,-117.655,120
137.401,-119.235,120
136.106,-120.759,120
134.749,-122.228,120
133.338,-123.645,120
131.878,-125.012,120
130.373,-126.329,120
128.83,-127.601,120
127.25,-128.827,120
125.639,-130.012,120
123.998,-131.156,120
122.332,-132.261,120
120.64,-133.329,120
118.928,-134.361,120
117.194,-135.359,120
115.443,-136.324,120
113.674,-137.258,120
111.889,-138.161,120
110.09,-139.034,120
108.277,-139.878,120
106.451,-140.695,120
104.613,-141.483,120
102.764,-142.244,120
100.904,-142.979,120
99.033,-143.687,120
97.153,-144.369,120
95.263,-145.023,120
93.364,-145.651,120
91.456,-146.25,120
89.539,-146.82,120
87.613,-147.359,120
85.678,-147.864,120
83.733,-148.331,120
81.775,-148.732,120,0
79.785,-148.925,120
77.793,-149.105,120
75.8,-149.273,120
73.806,-149.432,120
71.812,-149.582,120
69.817,-149.724,120
67.821,-149.859,120
65.825,-149.986,120
63.829,-150.109,120
61.833,-150.225,120
59.836,-150.336,120
57.838,-150.443,120
55.841,-150.544,120
53.843,-150.641,120
51.846,-150.734,120
49.848,-150.823,120
47.849,-150.909,120
45.851,-150.991,120
43.853,-151.069,120
41.854,-151.144,120
39.855,-151.216,120
37.856,-151.285,120
35.858,-151.352,120
33.859,-151.415,120
31.86,-151.476,120
29.86,-151.533,120
27.861,-151.588,120
25.862,-151.641,120
23.862,-151.691,120
21.863,-151.739,120
19.864,-151.785,120
17.864,-151.828,120
15.864,-151.869,120
13.865,-151.908,120
11.865,-151.944,120
9.865,-151.979,120
7.866,-152.011,120
5.866,-152.041,120
3.866,-152.069,120
1.866,-152.095,120
-0.134,-152.119,120
-2.133,-152.141,120
-4.133,-152.161,120
-6.133,-152.179,120
-8.133,-152.196,120
-10.133,-152.21,120
-12.133,-152.222,120
-14.133,-152.232,120
-16.133,-152.241,120
-18.133,-152.247,120
-20.133,-152.252,120
-22.133,-152.254,120
-24.133,-152.255,120
-26.133,-152.254,120
-28.133,-152.251,120
-30.133,-152.246,120
-32.133,-152.239,120
-34.133,-152.23,120
-36.133,-152.219,120
-38.133,-152.206,120
-40.133,-152.191,120
-42.133,-152.174,120
-44.133,-152.155,120
-46.133,-152.134,120
-48.132,-152.111,120
-50.132,-152.086,120
-52.132,-152.059,120
-54.132,-152.03,120
-56.132,-151.998,120
-58.131,-151.965,120
-60.131,-151.929,120
-62.131,-151.89,120
-64.13,-151.85,120
-66.13,-151.807,120
-68.129,-151.762,120
-70.129,-151.714,120
-72.128,-151.664,120
-74.127,-151.611,120
-76.127,-151.556,120
-78.126,-151.498,120
-80.125,-151.437,120
-82.124,-151.373,120
-84.123,-151.307,120
-86.122,-151.237,120
-88.12,-151.164,120
-91.295,-151.043,120,0
-91.295,-151.043,0,0
#PATH-POINTS-START Path
-91.698,-150.519,120,0
-93.691,-150.355,120
-95.672,-150.081,120
-97.636,-149.703,120
-99.579,-149.23,120
-101.5,-148.673,120
-103.396,-148.038,120
-105.266,-147.329,120
-107.109,-146.554,120
-108.927,-145.719,120
-110.717,-144.827,120
-112.48,-143.883,120
-114.216,-142.89,120
-115.924,-141.85,120
-117.605,-140.767,120
-119.259,-139.642,120
-120.885,-138.477,120
-122.483,-137.275,120
-124.053,-136.036,120
-125.595,-134.763,120
-127.108,-133.455,120
-128.593,-132.115,120
-130.047,-130.742,120
-131.471,-129.337,120
-132.863,-127.901,120
-134.223,-126.435,120
-135.549,-124.938,120
-136.84,-123.41,120
-138.093,-121.852,120
-139.308,-120.263,120
-140.481,-118.643,120
-141.61,-116.992,120
-142.692,-115.311,120
-143.724,-113.597,120
-144.701,-111.852,120
-145.616,-110.074,120
-146.464,-108.263,120
-147.241,-106.42,120
-147.934,-104.544,120
-148.535,-102.637,120
-149.032,-100.7,120
-149.412,-98.737,120
-149.655,-96.752,120
-149.747,-94.755,120
-149.668,-92.757,120
-149.418,-90.876,120,27.4
-149.418,-90.876,0,27.4
#PATH-POINTS-START Path
-55.486,13.043,120,0
-55.937,14.991,120
-56.425,16.931,120
-56.944,18.862,120
-57.49,20.786,120
-58.059,22.703,120
-58.648,24.615,120
-59.257,26.52,120
-59.881,28.42,120
-60.521,30.315,120
-61.175,32.205,120
-61.842,34.09,120
-62.52,35.972,120
-63.211,37.849,120
-63.911,39.722,120
-64.622,41.591,120
-65.343,43.457,120
-66.072,45.319,120
-66.811,47.178,120
-67.559,49.033,120
-68.314,50.885,120
-69.077,52.733,120
-69.848,54.579,120
-70.627,56.421,120
-71.413,58.26,120
-72.207,60.096,120
-73.007,61.929,120
-73.815,63.758,120
-74.629,65.585,120
-75.451,67.408,120
-76.28,69.228,120
-77.115,71.046,120
-77.957,72.86,120
-78.807,74.67,120
-79.663,76.478,120
-80.526,78.282,120
-81.396,80.083,120
-82.274,81.88,120
-83.158,83.674,120
-84.05,85.464,120
-84.949,87.25,120
-85.857,89.033,120
-86.772,90.811,120
-87.694,92.586,120
-88.626,94.356,120
-89.566,96.121,120
-90.514,97.882,120
-91.472,99.637,120
-92.44,101.388,120
-93.417,103.132,120
-94.405,104.871,120
-95.405,106.604,120
-96.415,108.33,120
-97.44,110.047,120
-98.476,111.758,120
-99.528,113.459,120
-100.594,115.151,120
-101.679,116.831,120
-102.781,118.5,120
-103.903,120.156,120
-105.049,121.795,120
-106.22,123.416,120
-107.42,125.016,120
-108.653,126.59,120
-109.927,128.132,120
-111.248,129.634,120
-112.626,131.083,120
-114.081,132.455,120,0
-115.785,133.488,120
-117.594,134.339,120
-119.476,135.014,120
-121.425,135.455,120
-123.418,135.591,120
-125.401,135.358,120
-127.299,134.739,120
-129.046,133.77,120
-130.61,132.528,120
-131.998,131.09,120
-133.233,129.517,120
-134.337,127.85,120
-135.334,126.116,120
-136.242,124.335,120
-137.075,122.517,120
-137.849,120.672,120
-138.568,118.806,120
-139.244,116.924,120
-139.881,115.028,120
-140.485,113.122,120
-141.06,111.206,120
-141.609,109.283,120
-142.136,107.354,120
-142.643,105.419,120
-143.132,103.48,120
-143.605,101.536,120
-144.065,99.59,120
-144.511,97.64,120
-144.947,95.688,120
-145.372,93.734,120
-145.788,91.778,120
-146.196,89.82,120
-146.596,87.86,120
-146.99,85.9,120
-147.377,83.937,120
-147.759,81.974,120
-148.136,80.01,120
-148.509,78.045,120
-148.878,76.079,120
-149.243,74.113,120
-149.605,72.146,120
-149.964,70.179,120
-150.301,68.319,120,0
-150.301,68.319,0,)";
std::vector<std::vector<pathPoint>> pathMain = convert_to_path(path_str);
std::vector<double> finSpeed = {50, 0, 0};
std::vector<double> startSpeed = {75, 50, 50};
//